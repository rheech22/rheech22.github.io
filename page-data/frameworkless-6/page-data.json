{"componentChunkName":"component---src-templates-post-tsx","path":"/frameworkless-6","result":{"data":{"markdownRemark":{"html":"<h2 id=\"싱글-페이지-애플리케이션\" style=\"position:relative;\"><a href=\"#%EC%8B%B1%EA%B8%80-%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98\" aria-label=\"싱글 페이지 애플리케이션 permalink\" class=\"header-anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>싱글 페이지 애플리케이션</h2>\n<p>SPA는 하나의 HTML 페이지로 실행되는 애플리케이션이다. 사용자가 다른 화면으로 이동할 때 뷰를 동적으로 재구성하여 보여주기 때문에 사용자가 경험할 수 있는 지연을 감소시키고 일반적으로 더 나은 UX를 제공할 수 있다.</p>\n<br />\n<h2 id=\"라우팅-시스템\" style=\"position:relative;\"><a href=\"#%EB%9D%BC%EC%9A%B0%ED%8C%85-%EC%8B%9C%EC%8A%A4%ED%85%9C\" aria-label=\"라우팅 시스템 permalink\" class=\"header-anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>라우팅 시스템</h2>\n<p>라우팅 시스템은 SPA를 구축하는데 크게 기여한다. 라우팅 시스템은 최소 두 가지 요소를 갖는다.</p>\n<ul>\n<li>경로 목록을 수집하는 레지스트리</li>\n<li>현재 URL의 리스너</li>\n</ul>\n<p>라우터는 URL이 변경될 때마다 해당 경로에 바인딩된 컴포넌트로 기존의 것을 대체한다.</p>\n<br />\n<h2 id=\"프래그먼트-식별자를-이용한-라우터-구현\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%9E%98%EA%B7%B8%EB%A8%BC%ED%8A%B8-%EC%8B%9D%EB%B3%84%EC%9E%90%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%9D%BC%EC%9A%B0%ED%84%B0-%EA%B5%AC%ED%98%84\" aria-label=\"프래그먼트 식별자를 이용한 라우터 구현 permalink\" class=\"header-anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프래그먼트 식별자를 이용한 라우터 구현</h2>\n<p>프래그먼트 식별자를 알기 위해선 URI(Uniform Resource Identifier)를 먼저 알아야 한다. URI란 인터넷 자원 식별자다. 여기서 인터넷 자원은 리소스, 즉 HTTP 요청 대상이다. URL은 우리가 가장 자주 접할 수 있는 URI 형식으로 포트, 도메인 네임, 경로, 쿼리 등과 같은 정보를 포함한다. 프래그먼트 식별자도 그 중 하나로 <code>#</code>으로 시작하는 부분이다. 프래그먼트는 웹 문서의 특정 섹션을 식별하는 목적으로 사용한다. 브라우저는 프래그먼트로 식별된 요소를 브라우저 뷰포트의 가장 상단으로 스크롤한다.</p>\n<p>프래그먼트를 포함한 링크를 <code>&#x3C;nav /></code>에 포함시킨다. 본문이 담길 컨테이너는 <code>&#x3C;main/></code>이 된다.</p>\n<deckgo-highlight-code language=\"html\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"8 9 11\">\n          <code slot=\"code\">&lt;html&gt;\n  &lt;head&gt;\n    &lt;link rel=&quot;shortcut icon&quot; href=&quot;../favicon.ico&quot; /&gt;\n    &lt;title&gt;router&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;nav&gt;\n      &lt;a href=&quot;#/&quot;&gt;home&lt;/a&gt;\n      &lt;a href=&quot;#/about&quot;&gt;about&lt;/a&gt;\n    &lt;/nav&gt;\n    &lt;main&gt;&lt;/main&gt;\n    &lt;script type=&quot;module&quot; src=&quot;index.js&quot;&gt;&lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;</code>\n        </deckgo-highlight-code>\n<p>각 페이지에 들어갈 내용이다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"4,14\">\n          <code slot=\"code\">// pages.js\n\nexport default container =&gt; {\n  const home = () =&gt; {\n    container.textContent = &#39;This is Home page&#39;\n  }\n\n  const about = () =&gt; {\n    container.textContent = &#39;This is About page&#39;\n  }\n\n  const notFound = () =&gt; {\n    container.textContent = &#39;Page Not Found !&#39;\n  }\n\n  return {\n    home,\n    about,\n    notFound\n  }\n}</code>\n        </deckgo-highlight-code>\n<p>중요한 것은 라우터다. 처음 언급했듯이 URL 변경을 감지하는 리스너와 경로 목록이 담긴 레지스트리가 필요하다. <code>start()</code>는 <code>checkRoutes()</code>를 실행, 또한 <code>hashchange</code>이벤트에 대한 핸들러로 <code>checkRoutes()</code>를 할당한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"7,13\">\n          <code slot=\"code\">// router.js\n\nexport default () =&gt; {\n  const router = {};\n\n  router.start = () =&gt; {\n    window.addEventListener(&#39;hashchange&#39;, checkRoutes);\n\n    if (!window.location.hash) {\n      window.location.hash = &#39;#/&#39;\n    }\n\n    checkRoutes();\n  }\n\n  return router;\n}</code>\n        </deckgo-highlight-code>\n<p><code>checkRoute()</code>는 현재 주소가 레지스트리에 등록되었는지 검사한다. 만약 등록된 주소라면 해당 루트의 컴포넌트를 바인딩하고 그렇지 않다면 <code>notFound()</code>를 실행한다. <code>setNotFound()</code>로 <code>notFound()</code>를 위한 컴포넌트를 연결하지 않았다면 빈 객체를 리턴하기 때문에 화면에는 아무 일도 일어나지 않는다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"9,27\">\n          <code slot=\"code\">// router.js\n\nexport default () =&gt; {\n   \n  // ... 생략\n\n  const routes = [];\n\n  const checkRoutes = () =&gt; {\n    const currentRoute = routes.find(route =&gt; {\n      return route.fragment === window.location.hash;\n    })\n\n    if (!currentRoute) {\n      notFound();\n      return;\n    }\n\n    currentRoute.component();\n  }\n\n  let notFound = () =&gt; {};\n\n  router.setNotFound = cb =&gt; {\n    notFound = cb;\n    return router;\n  }\n\n  return router;\n}</code>\n        </deckgo-highlight-code>\n<p>router의 마지막 메서드로 레지스트리 등록을 위한 <code>addRoutes()</code>를 추가한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"29,35\">\n          <code slot=\"code\">export default () =&gt; {\n  const router = {};\n\n  router.start = () =&gt; {\n    window.addEventListener(&#39;hashchange&#39;, checkRoutes);\n\n    if (!window.location.hash) {\n      window.location.hash = &#39;#/&#39;\n    }\n\n    checkRoutes();\n  }\n\n  const routes = [];\n\n  const checkRoutes = () =&gt; {\n    const currentRoute = routes.find(route =&gt; {\n      return route.fragment === window.location.hash;\n    })\n\n    if (!currentRoute) {\n      notFound();\n      return;\n    }\n\n    currentRoute.component();\n  }\n\n  router.addRoutes = routeList =&gt; {\n    Object.entries(routeList).map(([fragment, component]) =&gt; {\n      routes.push({ fragment, component });\n    })\n\n    return router;\n  }\n\n  let notFound = () =&gt; { };\n\n  router.setNotFound = cb =&gt; {\n    notFound = cb;\n    return router;\n  }\n\n  return router;\n}</code>\n        </deckgo-highlight-code>\n<p>컨트롤러에서 경로 레지스트리를 구성한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"10,18\">\n          <code slot=\"code\">import createPage from &#39;./pages.js&#39;;\nimport createRouter from &#39;./router.js&#39;;\n\nconst container = document.querySelector(&#39;main&#39;);\n\nconst pages = createPage(container);\n\nconst router = createRouter();\n\nconst routes = {\n  &#39;#/&#39;: pages.home,\n  &#39;#/about&#39;: pages.about,\n}\n\nrouter\n  .addRoutes(routes)\n  .setNotFound(pages.notFound)\n  .start();</code>\n        </deckgo-highlight-code>\n<p>동작하는 해시 라우터</p>\n<p><img src=\"/ee7ee8deedc18415f660c30b020491ac/router.gif\" alt=\"router\"></p>\n<p>라우터 흐름은 이렇다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 694px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f11febe4aac370873e4920a8d2f470b1/302a4/flow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.27586206896551%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAADJklEQVQ4y42U224bVRSG8xI8BOKeJ0CiIJUKgUAVF1yAkJB60wuEAEElIIEmBAVogUSoFaVxGifpOGmDcnCapPFhbM/Jc/Z47Bm7wSnQd/iq2T4wjSrci197aW/tf//rX2uviUboMoTfdMT6V68tcNxr0zuJiLvN0dk4TJwmcxsWUz8v8OWPvzJ5dYFLc1dZ2bxL1AnwAmcs8cSQLEGz5VF3DF44c57nX+7juRdf5eJXM0Kp07DGEw7J0tjcy5PJrXMtuyLW+5USzbY/Oh+rMGh5AonCVuTRPQ5FinVb5+HDmLgTEKRs+V9CL7AxHAPD1rFdg+8ym7z7bYYPZm/x3swSF35Y4f2ZJfbkKu3IxxunUDVVSoqMZmnolsq8tMNHv0h8siBxYe4WH89LXLyyypGq0mp7o7STAiXkXioeEGqYbp1W1BApR3GDbjcgbLsYlkL3QUCnk5y5T3jY6fhEsUcUeXRin3bUf2xCMzWRbjC4kFhgujo1XaaiFtEtBcc3B2T9tJzAYXI5z6VMnsnsHp/+sc1ivihIRcp9wuQFG1kpcn05I7C8scbC4g1yW3cwHY2yWqGsyNwrF3lr9javfCNx9rLES1+vMpXdE4pPETqi1wxbo6qVKSsFFKOC6RpPNLUT2Py0ccgXizt8fnObz27ukj2QCdte38OkyqJ1Qpc49oWHzdCmbqkijgcepauZ7PkNE8vR6Hb/83jgoSHY657Fllxjp6JwtyCzvHtAvqaKvXuKihvYI58TPzVLp6orQkyqyiq6pYtX7hSrvDGb4/WZHGcv3+bN2XXOTa+J+J25HPtyiapeQ1arYj2qllDrquiOYQeMPEwU6q5F7qjC2qFMdr/Eja1DpKMKKwcy64WKUBCk0k464/QPEinXBx6GLY+/ewGPTkJ6D3wansa/JyH/9AJOjgOe9u+HZH465aQwjdDBcEx+3ylybavAb3/e54qUZ2lf5vp2QSg9ffmpX8/2TeGJYtTYLZV5+/u+f+emJV6bljg/t8GZqVU+nN98NsL0tElixa4j1w0qpkHJ0EdI9tOz85nnYVKcVhpRH+FgMIwbX48BSMRGC4mnzf4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"flow\"\n        title=\"flow\"\n        src=\"/static/f11febe4aac370873e4920a8d2f470b1/31198/flow.png\"\n        srcset=\"/static/f11febe4aac370873e4920a8d2f470b1/fe9c7/flow.png 174w,\n/static/f11febe4aac370873e4920a8d2f470b1/39e45/flow.png 347w,\n/static/f11febe4aac370873e4920a8d2f470b1/31198/flow.png 694w,\n/static/f11febe4aac370873e4920a8d2f470b1/ee9b6/flow.png 1041w,\n/static/f11febe4aac370873e4920a8d2f470b1/302a4/flow.png 1080w\"\n        sizes=\"(max-width: 694px) 100vw, 694px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<br />\n<h2 id=\"정규식을-통한-경로-매개변수-추출\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EA%B7%9C%EC%8B%9D%EC%9D%84-%ED%86%B5%ED%95%9C-%EA%B2%BD%EB%A1%9C-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-%EC%B6%94%EC%B6%9C\" aria-label=\"정규식을 통한 경로 매개변수 추출 permalink\" class=\"header-anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정규식을 통한 경로 매개변수 추출</h2>\n<p>경로 매개변수(path parameter)는 URL에서 리소스를 식별해야 할 때 사용한다.</p>\n<p>다음 경로에서 123은 유저의 식별자다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">https://example.com/users/123</code>\n        </deckgo-highlight-code>\n<p>이를 <code>id</code>라는 매개변수로 표현한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">https://example.com/users/:id</code>\n        </deckgo-highlight-code>\n<p>매개변수를 갖는 경로를 레지스트리에 등록한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"6,7\">\n          <code slot=\"code\">const routes = {\n  &#39;#/&#39;: pages.home,\n  &#39;#/about&#39;: pages.about,\n  &#39;#/users&#39;: pages.users,\n  &#39;#/users/:id&#39;: pages.userDetail,\n  &#39;#/users/:id/:anotherId&#39;: pages.userAnotherDetail,\n  &#39;#/users/:id/:anotherId/:theOtherId&#39;: pages.userTheOtherDetail,\n}</code>\n        </deckgo-highlight-code>\n<p>매개변수를 포함한 경로에 매핑하는 컴포넌트는 인자를 받는다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"12,18\">\n          <code slot=\"code\">export default container =&gt; {\n  // ...\n\n  const users = () =&gt; {\n    container.textContent = &#39;This is Users page&#39;\n  }\n\n  const userDetail = ({ id }) =&gt; {\n    container.textContent = `This is User Detail Page with ID: ${id}`\n  }\n\n  const userAnotherDetail = ({ id, anotherId }) =&gt; {\n    container.textContent = `This is User Another Detail Page with ID: ${id}, another ID: ${anotherId}`\n  }\n\n  const userTheOtherDetail = ({ id, anotherId, theOtherId }) =&gt; {\n    container.textContent = `This is User Another Detail Page with ID: ${id}, another ID: ${anotherId}, theOtherId: ${theOtherId}`\n  }\n\n  // ...\n}</code>\n        </deckgo-highlight-code>\n<p><code>addRoutes()</code>는 이제 경로를 그대로 푸시하는 대신 경로 매개변수를 담는 리스트인 <code>params</code>와 경로 탐색을 위한 정규표현식인 <code>testRegExp</code>을 반환한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"3 7\">\n          <code slot=\"code\">router.addRoutes = routeList =&gt; {\n  Object.entries(routeList).map(([fragment, component]) =&gt; {\n    const params = [];\n\n    // ... 중략\n\n    routes.push({ component, params, testRegExp });\n  })\n\n  return router;\n}</code>\n        </deckgo-highlight-code>\n<p><code>replace()</code>는 어떤 패턴에 일치하는 일부, 또는 모든 부분이 교체된 새로운 문자열을 반환한다. 어떤 경우에 일부를 교체하고, 또는 모두를 교체할까? 만약 첫 번째 인자가 문자열이라면 첫 번째로 일치하는 문자열만을 교체한다. 만약 일치하는 모두를 교체하고 싶다면 <code>replaceAll()</code>을 사용해야 한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">const newStr = str.replace(regexp|substr, newSubstr|function)</code>\n        </deckgo-highlight-code>\n<p>한편, 첫 번째 인자가 정규식이라면 정규식의 플래그에 따라 일치하는 부분을 일부 또는 모두 교체한다. 두 번째 인자로는 대체 문자열 또는 함수를 받는다. 만약 함수라면 함수의 첫 번째 인자로 매치된 문자열, 두 번째 인자부터는 정규 표현식의 캡쳐 그룹에 속한 문자열이 주어진다. 이외에도 매치된 문자열의 index, 조사된 전체 문자열을 매개변수로 갖는다. 자세한 내용은 <a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/String/replace\">MDN</a>을 참고하자. 이 함수의 매개변수 갯수는 정규식에 따라 달라진다는 점에 유의하자.</p>\n<p><code>parsedFragment</code>는</p>\n<ul>\n<li><code>fragment</code>에서 <code>/:(\\w+)/</code>정규 표현식을 활용하여 각 경로의 매개변수를 찾는다.</li>\n<li>각 경로 매개변수를 <code>params</code>에 담는다.</li>\n<li>각 경로 매개변수를 또 다른 정규 표현식을 문자열로 나타낸 <code>'([^\\\\/]+)'</code>로 대체한다.</li>\n<li><code>/</code>를 <code>\\/</code>로 대체한다.</li>\n</ul>\n<p>최종 문자열에 행의 시작과 끝을 나타내는 앵커를 붙인 후 새로운 정규표현식 <code>testRegExp</code>을 생성한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"2,16\">\n          <code slot=\"code\">router.addRoutes = routeList =&gt; {\n  const ROUTE_PARAMETER_REGEXP = /:(\\w+)/g;\n  const URL_FRAGMENT_REGEXP = &#39;([^\\\\/]+)&#39;;\n  \n  Object.entries(routeList).map(([fragment, component]) =&gt; {\n    const params = [];\n\n    const parsedFragment = fragment\n      .replace(ROUTE_PARAMETER_REGEXP, (_, param) =&gt; {\n        params.push(param);\n\n        return URL_FRAGMENT_REGEXP;\n      })\n      .replace(/\\//g, &#39;\\\\/&#39;);\n\n    const testRegExp = new RegExp(`^${parsedFragment}$`);\n\n    routes.push({ component, params, testRegExp });\n  })\n\n  return router;\n}</code>\n        </deckgo-highlight-code>\n<p>만약 <code>fragment</code>가 <code>#/users/:id/:anotherId</code>라면</p>\n<ul>\n<li><code>id</code>와 <code>anotherId</code>를 <code>params</code>에 담는다.</li>\n<li>매개변수는 <code>'([^\\\\/]+)'</code>가 대체하여 <code>#/users/([^\\\\/]+)/([^\\\\/]+)</code>와 같은 모양이 된다.</li>\n<li><code>/</code>를 대체하면 <code>#\\/users\\/([^\\\\/]+)\\/([^\\\\/]+)</code>이 된다.</li>\n<li>최종적으로 <code>testRegExp</code>는 <code>^#\\/users\\/([^\\\\/]+)\\/([^\\\\/]+)$</code>와 같은 정규 표현식이 된다.</li>\n</ul>\n<p>이제 <code>hashChange</code>이벤트가 발생하면, <code>routes</code>를 순회하며 각 <code>route</code>의 유효성을 검증하고  <code>extractUrlParams()</code>를 통해 해당 루트에 필요한 파라미터를 추출한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"7 15\">\n          <code slot=\"code\">const checkRoutes = () =&gt; {\n  const { hash } = window.location;\n\n  const currentRoute = routes.find(route =&gt; {\n    const { testRegExp } = route;\n\n    return testRegExp.test(hash);\n  })\n\n  if (!currentRoute) {\n    notFound();\n    return;\n  }\n\n  const urlParams = extractUrlParams(currentRoute, hash);\n\n  // ...\n}</code>\n        </deckgo-highlight-code>\n<p><code>extractUrlParams()</code>는 정규 표현식으로 실제 주소에서 파라미터에 대응하는 값을 추출한다. 만약, <code>users/:id/:anotherId</code>의 형식에 <code>users/1/2</code>와 같은 실제 주소라면 <code>{ id: 1, anotherId: 2}</code>를 반환한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"8,16\">\n          <code slot=\"code\">const extractUrlParams = (route, hash) =&gt; {\n  if (route.param?.length === 0) {\n    return {}\n  }\n\n  const params = {};\n\n  const matches = hash.match(route.testRegExp);\n\n  matches.shift();\n\n  matches.forEach((paramValue, index) =&gt; {\n    const paramName = route.params[index];\n\n    params[paramName] = paramValue;\n  })\n\n  return params;\n}</code>\n        </deckgo-highlight-code>\n<p>컴포넌트에 추출한 파라미터를 넣고 실행한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"17\">\n          <code slot=\"code\">const checkRoutes = () =&gt; {\n  const { hash } = window.location;\n\n  const currentRoute = routes.find(route =&gt; {\n    const { testRegExp } = route;\n\n    return testRegExp.test(hash);\n  })\n\n  if (!currentRoute) {\n    notFound();\n    return;\n  }\n\n  const urlParams = extractUrlParams(currentRoute, hash);\n\n  currentRoute.component(urlParams);\n}</code>\n        </deckgo-highlight-code>\n<p>동작하는 매개변수 탐색<br>\n<img src=\"/feb01d5e27ce4f5c92bf217a8b95b264/params.gif\" alt=\"params\"></p>\n<br />\n<h2 id=\"히스토리-api를-이용한-라우터\" style=\"position:relative;\"><a href=\"#%ED%9E%88%EC%8A%A4%ED%86%A0%EB%A6%AC-api%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%9D%BC%EC%9A%B0%ED%84%B0\" aria-label=\"히스토리 api를 이용한 라우터 permalink\" class=\"header-anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>히스토리 API를 이용한 라우터</h2>\n<p>히스토리 라우터는 프래그먼트 식별자를 사용하지 않는다.</p>\n<deckgo-highlight-code language=\"html\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"8,13\">\n          <code slot=\"code\">&lt;html&gt;\n  &lt;head&gt;\n    &lt;link rel=&quot;shortcut icon&quot; href=&quot;../favicon.ico&quot; /&gt;\n    &lt;title&gt;router&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;nav&gt;\n      &lt;a data-navigation href=&quot;/&quot;&gt;home&lt;/a&gt;\n      &lt;a data-navigation href=&quot;/about&quot;&gt;about&lt;/a&gt;\n      &lt;a data-navigation href=&quot;/users&quot;&gt;users&lt;/a&gt;\n      &lt;a data-navigation href=&quot;/users/1&quot;&gt;user(1)&lt;/a&gt;\n      &lt;a data-navigation href=&quot;/users/1/2&quot;&gt;user(1)-2&lt;/a&gt;\n      &lt;a data-navigation href=&quot;/users/3/4/5&quot;&gt;user(3)-4-5&lt;/a&gt;\n    &lt;/nav&gt;\n    &lt;main&gt;&lt;/main&gt;\n    &lt;script type=&quot;module&quot; src=&quot;index.js&quot;&gt;&lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;</code>\n        </deckgo-highlight-code>\n<p>링크를 클릭할 때 기대하는 동작은 해당 경로에 매핑된 구성을 보여주는 것이다. 하지만 링크 요소를 클릭하는 경우 실제 주소에 요청을 날리기 때문에 404 에러가 발생한다. 이런 이유로 <code>data</code> 속성으로  네비게이션 속성을 갖는 <code>a</code>태그를 식별하고 클릭 이벤트의 기본 동작을 방지하는 방식을 사용한다. 그리고 URL의 변경되는 것을 감지할 수 있는 DOM 이벤트가 없기 때문에 <code>setInterval()</code>을 사용하여 변경을 주기적으로 확인한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  highlight-lines=\"7 12,15\">\n          <code slot=\"code\">const TICKTIME = 250;\nconst NAVIGATION = &#39;a[data-navigation]&#39;;\n\nrouter.start = () =&gt; {\n  checkRoutes();\n\n  window.setInterval(checkRoutes, TICKTIME)\n\n  document.body.addEventListener(&#39;click&#39;, (e) =&gt; {\n    const { target } = e;\n\n    if (target.matches(NAVIGATION)) {\n      e.preventDefault();\n      router.navigate(target.href);\n    }\n  })\n}</code>\n        </deckgo-highlight-code>\n<p>경로도 프래그먼트 식별자 없이 정의한다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">const routes = {\n  &#39;/&#39;: pages.home,\n  &#39;/about&#39;: pages.about,\n  &#39;/users&#39;: pages.users,\n  &#39;/users/:id&#39;: pages.userDetail,\n  &#39;/users/:id/:anotherId&#39;: pages.userAnotherDetail,\n  &#39;/users/:id/:anotherId/:theOtherId&#39;: pages.userTheOtherDetail,\n}</code>\n        </deckgo-highlight-code>\n<p>동작하는 히스토리 라우터<br>\n<img src=\"/26ef032f0978ef7a6028114a4083b36c/history.gif\" alt=\"history\"></p>\n<br/>\n<h2 id=\"출처\" style=\"position:relative;\"><a href=\"#%EC%B6%9C%EC%B2%98\" aria-label=\"출처 permalink\" class=\"header-anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>출처</h2>\n<p><em>프란세스코 스트라츨로, <a href=\"https://search.shopping.naver.com/book/search?bookTabType=ALL&#x26;pageIndex=1&#x26;pageSize=40&#x26;query=%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC%20%EC%97%86%EB%8A%94%20%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C%20%EA%B0%9C%EB%B0%9C&#x26;sort=REL\">『프레임워크 없는 프론트엔드 개발』</a>, 에이콘 출판(2021.01.21.)</em></p>","excerpt":"싱글 페이지 애플리케이션 SPA는 하나의 HTML 페이지로 실행되는 애플리케이션이다. 사용자가 다른 화면으로 이동할 때 뷰를 동적으로 재구성하여 보여주기 때문에 사용자가 경험할 수 있는 지연을 감소시키고 일반적으로 더 나은 UX를 제공할 수 있다. …","timeToRead":8,"headings":[{"id":"싱글-페이지-애플리케이션","value":"싱글 페이지 애플리케이션","depth":2},{"id":"라우팅-시스템","value":"라우팅 시스템","depth":2},{"id":"프래그먼트-식별자를-이용한-라우터-구현","value":"프래그먼트 식별자를 이용한 라우터 구현","depth":2},{"id":"정규식을-통한-경로-매개변수-추출","value":"정규식을 통한 경로 매개변수 추출","depth":2},{"id":"히스토리-api를-이용한-라우터","value":"히스토리 API를 이용한 라우터","depth":2},{"id":"출처","value":"출처","depth":2}],"frontmatter":{"path":"/frameworkless-6","date":"2023-03-04","title":"6장_라우터","tags":["javascript"],"series":"프레임워크 없는 프론트엔드 개발"}}},"pageContext":{"prev":{"path":"/frameworkless-5","title":"5장_HTTP 요청"},"next":{"path":"/frameworkless-7","title":"7장_상태 관리"}}},"staticQueryHashes":["4237238699"]}